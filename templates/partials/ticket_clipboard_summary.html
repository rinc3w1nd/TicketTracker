<article class="ticket-clipboard-summary">
  {% if 'header' in sections %}
    <header>
      <h1>Ticket #{{ ticket.id }} · {{ ticket.title }}</h1>
      <p>
        <strong>Created:</strong>
        {{ ticket.created_at.strftime('%b %d, %Y %H:%M') if ticket.created_at else '—' }}<br />
        <strong>Updated:</strong>
        {{ ticket.updated_at.strftime('%b %d, %Y %H:%M') if ticket.updated_at else '—' }}
      </p>
      {% if ticket_url %}
        <p><strong>Link:</strong> <a href="{{ ticket_url }}">{{ ticket_url }}</a></p>
      {% endif %}
    </header>
  {% endif %}

  {% if 'meta' in sections %}
    <section>
      <h2>Details</h2>
      <ul>
        <li><strong>Status:</strong> {{ ticket.status }}</li>
        <li><strong>Priority:</strong> {{ ticket.priority }}</li>
        <li><strong>Due:</strong> {{ ticket.due_badge_label }}</li>
        {% if ticket.sla_countdown %}
          <li><strong>SLA:</strong> {{ ticket.sla_countdown }}</li>
        {% endif %}
      </ul>
    </section>
  {% endif %}

  {% if 'people' in sections and (ticket.requester or ticket.watchers) %}
    <section>
      <h2>People</h2>
      <ul>
        {% if ticket.requester %}
          <li><strong>Requester:</strong> {{ ticket.requester }}</li>
        {% endif %}
        {% if ticket.watchers %}
          <li><strong>Watchers:</strong> {{ ticket.watchers|join(', ') }}</li>
        {% endif %}
      </ul>
    </section>
  {% endif %}

  {% if 'description' in sections and ticket.description %}
    <section>
      <h2>Description</h2>
      <p>{{ ticket.description|urlize|replace('\n', '<br />')|safe }}</p>
    </section>
  {% endif %}

  {% if 'links' in sections and ticket.links %}
    <section>
      <h2>Links</h2>
      <p>{{ ticket.links|urlize|replace('\n', '<br />')|safe }}</p>
    </section>
  {% endif %}

  {% if 'notes' in sections and ticket.notes %}
    <section>
      <h2>Notes</h2>
      <p>{{ ticket.notes|urlize|replace('\n', '<br />')|safe }}</p>
    </section>
  {% endif %}

  {% if 'tags' in sections and ticket.tags %}
    <section>
      <h2>Tags</h2>
      <ul>
        {% for tag in ticket.tags %}
          <li>{{ tag.name }}</li>
        {% endfor %}
      </ul>
    </section>
  {% endif %}

  {% if 'updates' in sections and updates %}
    <section>
      <h2>Recent Updates</h2>
      <ol>
        {% for update in updates %}
          <li>
            <p>
              <strong>{{ update.created_at.strftime('%b %d, %Y %H:%M') }}</strong>
              by
              {{ 'System' if update.is_system else (update.author or config.default_submitted_by) }}
            </p>
            {% if update.status_from or update.status_to %}
              <p>
                <strong>Status:</strong>
                {{ update.status_from or '—' }} → {{ update.status_to or '—' }}
              </p>
            {% endif %}
            <p>{{ update.body|urlize|replace('\n', '<br />')|safe }}</p>
          </li>
        {% endfor %}
      </ol>
    </section>
  {% endif %}
</article>
