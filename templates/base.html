<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% block title %}TicketTracker{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}" />
    {% block extra_styles %}{% endblock %}
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
  </head>
  {% set is_compact = compact_mode|default(true) %}
  {% set compact_value = '1' if is_compact else '0' %}
  <body class="{% if is_compact %}compact{% endif %}">
    <header class="app-header">
      <div class="brand">
        <span class="logo">
          <img
            src="{{ url_for('static', filename='img/ticket_stopwatch.svg') }}"
            alt="TicketTracker logo featuring a ticket with a stopwatch"
          />
        </span>
        <div class="brand-text">
          <h1>TicketTracker</h1>
          <p class="subtitle">Local-first ticketing desk</p>
        </div>
      </div>
      {% set toggle_label = 'Switch to standard layout (currently compact)' if is_compact else 'Switch to compact layout (currently standard)' %}
      <nav class="nav-links">
        <a
          href="{{ url_for('tickets.list_tickets', compact=compact_value) }}"
          class="icon-button"
          aria-label="View tickets"
          title="View tickets"
        >
          <span class="icon" aria-hidden="true">
            <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
              <rect x="5" y="6" width="14" height="3" rx="1.5"></rect>
              <rect x="5" y="11" width="14" height="3" rx="1.5"></rect>
              <rect x="5" y="16" width="14" height="3" rx="1.5"></rect>
            </svg>
          </span>
          <span class="sr-only">View tickets</span>
        </a>
        <a
          href="{{ url_for('tickets.create_ticket', compact=compact_value) }}"
          class="button primary icon-button"
          aria-label="Create a new ticket"
          title="Create a new ticket"
        >
          <span class="icon" aria-hidden="true">＋</span>
          <span class="sr-only">Create a new ticket</span>
        </a>
        <a
          href="{{ url_for('settings.view_settings', compact=compact_value) }}"
          class="icon-button"
          aria-label="Configure settings"
          title="Configure settings"
        >
          <span class="icon" aria-hidden="true">⚙️</span>
          <span class="sr-only">Settings</span>
        </a>
        <a
          href="{{ compact_toggle_url|default(request.url) }}"
          class="button icon-button toggle-compact"
          role="switch"
          aria-checked="{{ 'true' if is_compact else 'false' }}"
          aria-label="{{ toggle_label }}"
          title="{{ toggle_label }}"
        >
          <span class="icon" aria-hidden="true">
            {% if is_compact %}
              <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                <rect x="4" y="5" width="16" height="4" rx="1.5"></rect>
                <rect x="4" y="11" width="16" height="4" rx="1.5"></rect>
                <rect x="4" y="17" width="16" height="2" rx="1"></rect>
              </svg>
            {% else %}
              <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                <rect x="4" y="5" width="7" height="7" rx="1.5"></rect>
                <rect x="13" y="5" width="7" height="7" rx="1.5"></rect>
                <rect x="4" y="14" width="7" height="7" rx="1.5"></rect>
                <rect x="13" y="14" width="7" height="7" rx="1.5"></rect>
              </svg>
            {% endif %}
          </span>
          <span class="sr-only">{{ toggle_label }}</span>
        </a>
      </nav>
    </header>

    <main class="content">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="flash-container">
            {% for category, message in messages %}
              <div class="flash {{ category }}">{{ message }}</div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </main>

    <footer class="app-footer">
      <p>Uploads stored in <code>{{ app_config.uploads_path }}</code>. Customize colors and SLAs via the JSON config.</p>
    </footer>
    {% block scripts %}{% endblock %}
  </body>
</html>
